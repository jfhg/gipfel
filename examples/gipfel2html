#!/bin/sh

cat << EOF
<html>
<head>
<style type="text/css">
#gipfel { display: block; position: relative; width: 1536px; height: 864px; margin: 0; padding: 0; }
#gipfel li { visibility: hidden; list-style-type: none; position: absolute; background: url(25w.png); border: 1px solid black; font-family: sans-serif; font-size: x-small; color: #000; padding: 0; line-height: 1.3em; overflow: hidden; }
#gipfel span { visibility: hidden; position: absolute; left: 0; right: 0; display: block; padding: 5px; }
#gipfel:hover li { visibility: visible; }
#gipfel li:hover span {visibility: visible;}
EOF

i=0
grep -v "^#" gipfelweb/gipfel/${1}.gipf | \
while read name height x y dist flags dummy; do
	thumb_w=`identify -format %w gipfelweb/thumbs/${name}`
	thumb_h=`identify -format %h gipfelweb/thumbs/${name}`

	echo "#id_${i} {left:$((${x} - 20 / 2))px; top: $((${y} - 20 / 2))px; width: 20px; height: 20px;}"
	echo "#id_${i}:hover {width: ${thumb_w}px; height: ${thumb_h}px; background: url(thumbs/${name});}"

	i=$((${i} + 1))
done

echo "</style></head>"
echo "<body bgcolor=\"#333333\">"
echo "<div id=\"gipfel\"><img src=\"slides/${1}.jpg\"/>"

i=0
grep -v "^#" gipfelweb/gipfel/${1}.gipf | \
while read name height x y dist flags dummy; do
	if [ "${flags}" = "HIDDEN" ]; then
		continue
	fi

	echo "<li id=\"id_${i}\"><a href=\"${name%.jpg}.html\"><span>${name} (${height}m)</span></a></li>"

	i=$((${i} + 1))
done

cat << EOF
</ul>
</div>
</body>
<html>
EOF
